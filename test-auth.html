<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Teste Auth Nexus</title>
</head>
<body>

<h2>Teste Cadastro Nexus</h2>

<button onclick="register()">Registrar</button>
<button onclick="verify()">Verificar OTP</button>
<button onclick="login()">Login</button>

<pre id="out"></pre>

<script>
const API = "https://nexus-site-oufm.onrender.com/api/auth";
const out = document.getElementById("out");

function show(x){
  out.textContent = typeof x === "string"
    ? x
    : JSON.stringify(x, null, 2);
}

async function register(){
  try {
    const r = await fetch(API + "/register", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        email: "teste@nexus.com",
        password: "123456",
        cpf: "12345678909"
      })
    });
    show(await r.json());
  } catch (e){
    show("ERRO REGISTER: " + e.message);
  }
}

async function verify(){
  const otp = prompt("Digite o OTP recebido no e-mail:");
  if (!otp) return;

  try {
    const r = await fetch(API + "/verify-otp", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        email: "teste@nexus.com",
        otp
      })
    });
    show(await r.json());
  } catch (e){
    show("ERRO VERIFY: " + e.message);
  }
}

async function login(){
  try {
    const r = await fetch(API + "/login", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        email: "teste@nexus.com",
        password: "123456"
      })
    });
    show(await r.json());
  } catch (e){
    show("ERRO LOGIN: " + e.message);
  }
}
</script>

</body>
</html>