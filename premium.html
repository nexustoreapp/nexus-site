<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Nexus Premium</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="icon" type="image/png" href="favicon.png" />
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700&display=swap" />
</head>

<body>
  <!-- NAV -->
  <header class="topbar">
    <a href="index.html" class="brand">
      <img src="logo.png" class="brand-logo" />
      <span class="brand-name">Nexus</span>
    </a>

    <button class="nav-toggle" id="navToggle">
      <span class="bar"></span>
      <span class="bar"></span>
      <span class="bar"></span>
    </button>

    <nav class="nav" id="navMenu">
      <a href="index.html" class="nav-link">Início</a>
      <a href="premium.html" class="nav-link active">Premium</a>
      <a href="assinatura.html" class="nav-link">Assinatura</a>
      <a href="login.html" class="nav-link">Entrar</a>
    </nav>
  </header>

  <main class="page">

    <h1>Premium Nexus</h1>
<p>Compare em lojas grandes e pequenas com descontos exclusivos.</p>

    <!-- BUSCA DEMO -->
    <section class="premium-search">
      <h2>Teste a busca demo</h2>
      <p>Digite um produto para ver como a comparação funciona (os dados ainda são fictícios).</p>

      <form id="premiumSearchForm" class="search-form">
        <input
          type="text"
          id="premiumQuery"
          class="input-search"
          placeholder="Ex.: notebook gamer, teclado mecânico, headset..."
          required
        />
        <button type="submit" class="btn-outline full">
          Buscar ofertas demo
        </button>
      </form>

      <div id="premiumSearchResults" class="search-results"></div>
    </section>

<div class="plans-grid">

      <!-- SEMANAL -->
      <article class="plan-card">
        <h2>Premium Semanal</h2>
        <p class="plan-price">R$ 8,99 <span>/ semana</span></p>

        <ul class="plan-list">
          <li>Acesso a todas as lojas</li>
          <li>Descontos exclusivos</li>
        </ul>

        <a href="assinatura.html" class="btn-outline full">Assinar semanal</a>
      </article>

      <!-- MENSAL -->
      <article class="plan-card">
        <h2>Premium Mensal</h2>
        <p class="plan-price">R$ 16,99 <span>/ mês</span></p>

        <ul class="plan-list">
          <li>Todos os benefícios Premium</li>
          <li>Melhor custo-benefício mensal</li>
        </ul>

        <a href="assinatura.html" class="btn-outline full">Assinar mensal</a>
      </article>

      <!-- ANUAL -->
      <article class="plan-card">
        <h2>Premium Anual</h2>
        <p class="plan-price">R$ 210,99 <span>/ ano</span></p>

        <ul class="plan-list">
          <li>Plano mais econômico</li>
          <li>Acesso premium o ano inteiro</li>
        </ul>

        <a href="assinatura.html" class="btn-outline full">Assinar anual</a>
      </article>

    </div>
  </main>

  <footer class="footer">
    <p>Nexus © 2025 – Comparador Gamer & Tech com IA.</p>
  </footer>

   <script>
    // MENU MOBILE
    const navToggle = document.getElementById("navToggle");
    const navMenu = document.getElementById("navMenu");

    if (navToggle && navMenu) {
      navToggle.addEventListener("click", () => {
        navMenu.classList.toggle("nav-open");
      });
    }

    // BUSCA PREMIUM → chama backend /api/search/demo
    const premiumForm = document.getElementById("premiumSearchForm");
    const premiumInput = document.getElementById("premiumQuery");
    const premiumResults = document.getElementById("premiumSearchResults");

    async function handlePremiumSearch(event) {
      event.preventDefault();

      if (!premiumInput || !premiumResults) return;

      const termo = premiumInput.value.trim();
      if (!termo) return;

      // estado de carregando
      premiumResults.innerHTML = "<p>Buscando ofertas demo...</p>";

      try {
        const response = await fetch("http://localhost:3000/api/search/demo", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({ query: termo }),
        });

        if (!response.ok) {
          throw new Error("Erro ao chamar a API");
        }

        const data = await response.json();

        if (!data.ok || !Array.isArray(data.results) || data.results.length === 0) {
          premiumResults.innerHTML =
            "<p>Nenhum resultado encontrado na demo para esse termo.</p>";
          return;
        }

        // monta a listinha de resultados
        const list = document.createElement("ul");
        list.className = "results-list";

        data.results.forEach((item) => {
          const li = document.createElement("li");
          const price =
            typeof item.price === "number"
              ? "R$ " + item.price.toFixed(2).replace(".", ",")
              : item.price;

          li.innerHTML = `
            <strong>${item.title}</strong><br />
            <span>${item.store}</span> — <span>${price}</span>
          `;
          list.appendChild(li);
        });

        premiumResults.innerHTML = "";
        premiumResults.appendChild(list);
      } catch (err) {
        console.error(err);
        premiumResults.innerHTML =
          "<p>Ocorreu um erro ao buscar as ofertas demo. Verifique se o servidor do backend está rodando.</p>";
      }
    }

    if (premiumForm) {
      premiumForm.addEventListener("submit", handlePremiumSearch);
    }
  </script>
</body>
</html>
